{{>/layout/main-header}}

<style>
    .email-container {
        position: relative;
    }

    .email-container .btn {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
    }
    /* ëª¨ë‹¬ì°½ ìŠ¤íƒ€ì¼ */
    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
    }

    .modal-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 30%;
        text-align: center;
        border-radius: 10px;
    }

    .modal-content p {
        font-size: 18px;
        margin-bottom: 10px;
    }

    .modal-content input {
        font-size: 30px;
        text-align: center;
        width: 80%;
        margin: 20px auto; /* ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ì†ì„± */
        padding: 10px;
        display: block; /* ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ì†ì„± */
    }

    .modal-buttons {
        display: flex;
        justify-content: center;
        gap: 20px;
    }

    .modal-buttons button {
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    #cancelBtn {
        background-color: #f0f0f0;
    }

    #confirmBtn {
        background-color: #4CAF50;
        color: white;
    }


</style>

<div class="container">
    <div class="my_auth_box">
        <div class="my_auth_form_box">
            <div class="my_auth_form_box_title">JSotry</div>
            <div class="my_error_box my_hidden">

            </div>
            <form action="/join" method="post" id="joinForm">
                <input id="username" class="my_auth_form_box_input" type="text" name="username" placeholder="ìœ ì €ë„¤ì„"
                       maxlength="20" value="ssar1" required/>
                <div id="usernameExist" class="my_hidden" style="color: red">ì¤‘ë³µëœ ì•„ì´ë””ì…ë‹ˆë‹¤.</div>
                <div id="usernameNoExist" class="my_hidden" style="color: green">ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤.</div>

                <input id="password" class="my_auth_form_box_input" type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸"
                       maxlength="20" value="1234" required/>

                <input id="same-password" class="my_auth_form_box_input" type="password" name="" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸"
                       maxlength="20" value="1234" required/>
                <div id="nameCheckFalse" style="color: red">ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
                <div id="nameCheckTrue" style="color: green">ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.</div>

                <div class="email-container">
                    <input class="my_auth_form_box_input" id="email" type="email" name="email" placeholder="ì´ë©”ì¼" maxlength="60"
                           value="ssar1@nate.com" required/>
                    <button class="btn btn-outline-success btn-sm" type="submit" id="emailAuthButton" onclick="emailCheck()">ì¸ì¦í•˜ê¸°</button>
                </div>

                <button type="submit" id="joinBtn" class="my_secondary_btn">íšŒì›ê°€ì…</button>
            </form>
            <div class="my_auth_form_box_link">
                <div><a href="/login-form">ë¡œê·¸ì¸</a></div>
                <div><a href="/user/password-reset-form">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a></div>
            </div>
        </div>
    </div>
    <br/>
</div>

<!-- ëª¨ë‹¬ì°½ êµ¬ì¡° -->
<div id="authModal" class="modal">
    <div class="modal-content">
        <p style="font-size: 30px">ğŸ’Œ</p>
        <input type="text" id="authCode" value="11455" placeholder="ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" />
        <div class="modal-buttons">
            <button id="cancelBtn">ì·¨ì†Œ</button>
            <button id="confirmBtn">í™•ì¸</button>
        </div>
    </div>
</div>



<script>
    // ëª¨ë‹¬ì°½ì„ ë³´ì´ê²Œ í•˜ëŠ” í•¨ìˆ˜
    function showModal() {
        $('#authModal').css('display', 'block');
    }

    // "ì¸ì¦í•˜ê¸°" ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ì°½ ë³´ì´ê¸°
    $('#emailAuthButton').on('click', function() {
        emailCheck();
        showModal();
    });

    // í™•ì¸ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ì°½ ë‹«ê¸°
    $('#confirmBtn').on('click', function() {
        $('#authModal').css('display', 'none');
    });

    // ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ì°½ ë‹«ê¸°
    $('#cancelBtn').on('click', function() {
        $('#authModal').css('display', 'none');
    });

    <!-- ì´ë©”ì¼ ì£¼ì†Œ ë³´ë‚´ê¸° -->
    function emailCheck () {
        console.log($("#email").val());
        let email = encodeURIComponent($("#email").val());

        $.ajax({
            url: '/sendmail',
            data: {email: email},
            type: 'GET'

        }).done((res) => {
            console.log("Res " + JSON.stringify(res));

        }).fail((res) => {
            alert("ì˜¤ë¥˜");
        });

    }


    <!--username ì¤‘ë³µ ì²´í¬ -->
    $("#username").on("keyup", _.debounce(function () {
        console.log($(this).val());
        let username = $(this).val();

        $.ajax({
            url: '/username-check',
            data: {username: username},
            type: 'GET'

        }).done((res) => {
            console.log("Res " + JSON.stringify(res));

            if (res.body === "USER_EXIST") {
                $("#usernameExist").removeClass("my_hidden");
                $("#usernameNoExist").addClass("my_hidden")
            }

            if (res.body === "USER_NO_EXIST") {
                $("#usernameExist").addClass("my_hidden");
                $("#usernameNoExist").removeClass("my_hidden");
            }

            if ((username) === "") {
                $("#usernameNoExist").addClass("my_hidden");
                $("#usernameExist").addClass("my_hidden");
            }

        }).fail((res) => {
            alert("ì˜¤ë¥˜");
        });

    }, 500));

    // username ì¤‘ë³µ ì²´í¬ ë


    <!--    ë¹„ë°€ë²ˆí˜¸ ë™ì¼ ì²´í¬ -->
    $("#nameCheckFalse").addClass("my_hidden");
    $("#nameCheckTrue").addClass("my_hidden");

    $("#same-password").on("input", function () {
        let password = $("#password").val();
        // console.log("íŒ¨ìŠ¤ì›Œë“œ = " + password);

        let confirmPassword = $("#same-password").val();
        // console.log("í™•ì¸ìš© = " + confirmPassword);

        if (password === confirmPassword) {
            $("#nameCheckTrue").removeClass("my_hidden");
            $("#nameCheckFalse").addClass("my_hidden");
            $("#joinBtn").css("background-color", "green");

            // ê°’ì„ ë‹¤ ì§€ì› ìœ¼ë©´ ë‹¤ì‹œ ë‘˜ ë‹¤ my_hidden ë„£ì–´ì¤˜ì•¼í•¨
        } else if (confirmPassword === "") {
            $("#nameCheckFalse").addClass("my_hidden");
            $("#nameCheckTrue").addClass("my_hidden");
            $("#joinBtn").css("background-color", "");

        } else {
            $("#nameCheckFalse").removeClass("my_hidden");
            $("#nameCheckTrue").addClass("my_hidden");
            $("#joinBtn").css("background-color", "");
        }
    });
    // ë¹„ë°€ë²ˆí˜¸ ë™ì¼ì²´í¬ ë


    // ë¹„ë²ˆì´ ë‹¤ë¥´ë©´ form ì œì¶œ ëª»í•˜ê²Œ ë§‰ì•„ë†“ìŒ
    $("#joinForm").on("submit", function (e) {
        let password = $("#password").val();
        // console.log("íŒ¨ìŠ¤ì›Œë“œ = " + password);

        let confirmPassword = $("#same-password").val();
        // console.log("í™•ì¸ìš© = " + confirmPassword);

        if (password !== confirmPassword) {
            e.preventDefault();

            swal({
                text: "ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”",
                icon: "warning",
                button: "í™•ì¸"
            });

        } else if (confirmPassword === "") {
            e.preventDefault();

            swal({
                text: "ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”",
                icon: "warning",
                button: "í™•ì¸"
            });
        }
    });
    // ë¹„ë²ˆì´ ë‹¤ë¥´ë©´ form ì œì¶œ ëª»í•˜ê²Œ ë§‰ì•„ë†“ìŒ

</script>


{{>/layout/footer}}